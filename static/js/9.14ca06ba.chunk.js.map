{"version":3,"sources":["containers/Profile/styles.js","utils/imageResize.js","store/actions/profileActions.js","containers/Profile/Profile.js"],"names":["styles","theme","container","display","profile","width","flexWrap","alignSelf","profileForm","boxSizing","padding","paper","form","logoContainer","& div","margin","transform","& img","height","heading","profileDetails","textField","marginBottom","spacing","unit","button","concat","readFileAsUrl","file","Promise","resolve","fileReader","FileReader","onload","event","target","result","readAsDataURL","imageResize","imageUrl","type","canvas","document","createElement","image","Image","ctx","getContext","clearRect","drawImage","toBlob","blob","src","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","uploadProfileSync","str","data","Profile","state","isUpdate","name","tel","handleInputChange","e","field","_this","setState","value","submitProfileForm","preventDefault","getElementById","photo","files","then","props","onSubmitProfile","submitProfileWithoutPicture","this","userName","prevState","nextState","_this2","classes","_this$state","react_default","a","react","index_es","className","noValidate","onSubmit","Logo","alt","variant","color","align","gutterBottom","required","id","label","onChange","autoComplete","fullWidth","size","loading","Spinner","uploadingImage","style","imageUploadProgress","error","uploadingImageFail","Fragment","success","react_router","to","item","xs","sm","md","Component","connect","auth","uploadingImageSuccess","dispatch","img","getState","idToken","actionTypes","storageRef","storage","ref","ext","match","metadata","contentType","uploadTask","child","put","on","TaskEvent","STATE_CHANGED","snapshot","progress","bytesTransferred","totalBytes","console","log","getDownloadURL","downloadURL","userId","localId","photoUrl","key","fetch","method","body","JSON","stringify","response","json","err","actions","withStyles"],"mappings":"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","file":"static/js/9.14ca06ba.chunk.js","sourcesContent":["const styles = theme => ({\r\n  container:{\r\n    display:'flex'\r\n  },\r\n  profile:{\r\n    width:'100%',\r\n    display:'flex',\r\n    flexWrap:'wrap',\r\n    alignSelf:'center'\r\n  },\r\n  profileForm:{\r\n    width:'100%',\r\n    display:'flex',\r\n    flexWrap:'wrap',\r\n    boxSizing:'border-box',\r\n    padding:'30px'\r\n  },\r\n  paper:{\r\n    width:'100%',\r\n    display:'flex',\r\n    flexWrap:'wrap',\r\n    padding:'40px',\r\n    boxSizing:'border-box'\r\n  },\r\n  form:{\r\n    display:'flex',\r\n    flexWrap:'wrap',\r\n    width:'100%'\r\n  },\r\n  logoContainer:{\r\n    width:'100%',\r\n    display:'flex',\r\n    padding:'5px',\r\n    boxSizing:'border-box',\r\n    '& div':{\r\n      width:'30%',\r\n      margin:'0 auto',\r\n      transform:'rotate(30deg)',\r\n      '& img':{\r\n        width:'100%',\r\n        height:'auto'\r\n      }\r\n    }\r\n  },\r\n  heading:{\r\n    width:'100%',\r\n    padding:'5px',\r\n    boxSizing:'border-box',\r\n    display:'flex'\r\n  },\r\n  profileDetails:{\r\n    width:'100%',\r\n    display:'flex',\r\n    flexWrap:'wrap',\r\n    boxSizing:'border-box',\r\n  },\r\n  textField:{\r\n    marginBottom:theme.spacing.unit\r\n  },\r\n  button:{\r\n    margin:`${theme.spacing.unit}px auto`\r\n  },\r\n})\r\n\r\nexport default styles\r\n","export const readFileAsUrl = (file) =>{\r\n  return new Promise(resolve=>{\r\n    const fileReader=new FileReader();\r\n    fileReader.onload=(event)=>{\r\n      resolve(event.target.result)\r\n    }\r\n    fileReader.readAsDataURL(file)\r\n  })\r\n}\r\n\r\nexport const imageResize = (imageUrl,type) =>{\r\n  return new Promise(resolve=>{\r\n    let canvas= document.createElement('canvas');\r\n    let maxHeight= 100;\r\n    let image= new Image();\r\n    image.onload=(event)=>{\r\n      const ctx=canvas.getContext('2d');\r\n      if(image.height > maxHeight){\r\n        image.width *= maxHeight/image.height ;\r\n        image.height=maxHeight\r\n      }\r\n      ctx.clearRect(0,0,canvas.width,canvas.height);\r\n      canvas.height=image.height;\r\n      canvas.width=image.width;\r\n      ctx.drawImage(image,0,0,image.width,image.height);\r\n      canvas.toBlob((blob)=>{\r\n        resolve(blob)\r\n      },type)\r\n    }\r\n    image.src=imageUrl;\r\n  })\r\n}\r\n","import firebase from 'firebase';\r\nimport * as actionTypes from './actionTypes';\r\n\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyArs2eYMjFtvxRpRmYqWexaDuQnd0OLX44\",\r\n  authDomain: \"electrostore-bb2a3.firebaseapp.com\",\r\n  databaseURL: \"https://electrostore-bb2a3.firebaseio.com\",\r\n  projectId: \"electrostore-bb2a3\",\r\n  storageBucket: \"electrostore-bb2a3.appspot.com\",\r\n  messagingSenderId: \"41927039846\",\r\n  appId: \"1:41927039846:web:47b1904dc2ed6b7c\",\r\n};\r\n\r\nfirebase.initializeApp(firebaseConfig);\r\n\r\nconst uploadProfileSync= (type,str) =>{\r\n  return {\r\n    type:type,\r\n    data:str\r\n  }\r\n}\r\nexport const uploadProfileWithoutPicture =(name,tel) =>{\r\n  return (dispatch,getState)=>{\r\n    dispatch(uploadProfileSync(actionTypes.PROFILE_UPLOAD_START,null));\r\n    const profile={name:name,tel:tel}\r\n    const key=getState().auth.key;\r\n    const idToken=getState().auth.idToken;\r\n    fetch(`https://electrostore-bb2a3.firebaseio.com/users/${key}.json?auth=${idToken}`,{\r\n      method:'PATCH',\r\n      body:JSON.stringify(profile)\r\n    }).then(response=>response.json()).then(response=>{\r\n      dispatch(uploadProfileSync(actionTypes.PROFILE_UPLOAD_SUCCESS,null));\r\n    }).catch(err=>{\r\n      dispatch(uploadProfileSync(actionTypes.PROFILE_UPLOAD_FAIL,null))\r\n    });\r\n  }\r\n}\r\nexport const uploadProfileInfoAsync = (name,tel,img,type,isUpdate) =>{\r\nreturn (dispatch,getState) =>{\r\n  const idToken=getState().auth.idToken;\r\n\r\n  dispatch(uploadProfileSync(actionTypes.IMAGE_UPLOAD_START, null));\r\n  let file = img\r\n\r\n  // Create a root reference\r\n  var storageRef = firebase.storage().ref();\r\n\r\n  let ext=type.match(/jpe?g|png/g)[0];\r\n  // Create a reference to 'images/mountains.jpg'\r\n\r\n  let metadata = {\r\n    contentType: type\r\n  };\r\n\r\n  // Upload file and metadata to the object 'images/mountains.jpg'\r\n  var uploadTask = storageRef.child('profilePictures/' + name + '.' + ext ).put(file, metadata);\r\n\r\n  // Listen for state changes, errors, and completion of the upload.\r\n  uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, // or 'state_changed'\r\n    function(snapshot) {\r\n      // Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded\r\n      var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n      console.log('Upload is ' + progress + '% done');\r\n      dispatch(uploadProfileSync(actionTypes.UPLOADING_IMAGE, progress))\r\n    }, function(error) {\r\n      dispatch(uploadProfileSync(actionTypes.IMAGE_UPLOAD_FAIL, null))\r\n\r\n  }, function() {\r\n    // Upload completed successfully, now we can get the download URL\r\n    dispatch(uploadProfileSync(actionTypes.IMAGE_UPLOAD_SUCCESS, null))\r\n    uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {\r\n      const userId=getState().auth.localId;\r\n\r\n      const profile={name:name,userId:userId,tel:tel,photoUrl:downloadURL}\r\n      dispatch(uploadProfileSync(actionTypes.PROFILE_UPLOAD_START,null));\r\n        if(isUpdate){\r\n          const key=getState().auth.key;\r\n          fetch(`https://electrostore-bb2a3.firebaseio.com/users/${key}.json?auth=${idToken}`,{\r\n            method:'PATCH',\r\n            body:JSON.stringify(profile)\r\n          }).then(response=>response.json()).then(response=>{\r\n            dispatch(uploadProfileSync(actionTypes.PROFILE_UPLOAD_SUCCESS,null));\r\n          }).catch(err=>{\r\n            dispatch(uploadProfileSync(actionTypes.PROFILE_UPLOAD_FAIL,null))\r\n            // Create a reference to the file to delete\r\n            var desertRef = storageRef.child('profilePictures/'+name+'.'+ext);\r\n            // Delete the file\r\n            desertRef.delete().then(function() {\r\n              // File deleted successfully\r\n            }).catch(function(error) {\r\n              // Uh-oh, an error occurred!\r\n            });\r\n          });\r\n        }\r\n        else {\r\n          fetch(`https://electrostore-bb2a3.firebaseio.com/users.json?auth=${idToken}`,{\r\n            method:'POST',\r\n            body:JSON.stringify(profile)\r\n          }).then(response=>response.json()).then(response=>{\r\n            dispatch(uploadProfileSync(actionTypes.PROFILE_UPLOAD_SUCCESS,null));\r\n          }).catch(err=>{\r\n            dispatch(uploadProfileSync(actionTypes.PROFILE_UPLOAD_FAIL,null))\r\n            // Create a reference to the file to delete\r\n            var desertRef = storageRef.child('profilePictures/'+name+'.'+ext);\r\n            // Delete the file\r\n            desertRef.delete().then(function() {\r\n              // File deleted successfully\r\n            }).catch(function(error) {\r\n              // Uh-oh, an error occurred!\r\n            });\r\n          });\r\n        }\r\n\r\n    });\r\n  });\r\n}\r\n\r\n}\r\n","import React , { Component, Fragment } from 'react';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport { Redirect } from 'react-router-dom';\r\nimport Logo from '../../logo.svg';\r\nimport Spinner from '../../components/Spinner/Spinner';\r\nimport { connect } from 'react-redux';\r\nimport { Grid, Paper, Typography, Button, TextField, } from '@material-ui/core';\r\nimport styles from './styles';\r\nimport { readFileAsUrl, imageResize } from '../../utils/imageResize';\r\nimport * as actions from '../../store/actions/profileActions';\r\n\r\n\r\nclass Profile extends Component {\r\n\r\n  state={\r\n    isUpdate:false,\r\n    name:null,\r\n    tel:null\r\n  }\r\n  componentDidMount() {\r\n    this.setState({\r\n      isUpdate:this.props.userName!==null,\r\n      tel:this.props.tel,\r\n      name:this.props.userName\r\n    })\r\n  }\r\n  handleInputChange= (e,field) =>{\r\n    switch(field) {\r\n      case 'name':\r\n        this.setState({name:e.target.value})\r\n        break;\r\n      case 'tel':\r\n        this.setState({tel:e.target.value})\r\n        break;\r\n      default: return null\r\n    }\r\n  }\r\n  submitProfileForm= (event) => {\r\n    event.preventDefault();\r\n    let name=document.getElementById('name').value;\r\n    let tel=document.getElementById('tel').value;\r\n    let photo=document.getElementById('photo').files[0];\r\n    if(!this.state.isUpdate) {\r\n      readFileAsUrl(photo).then(imageUrl=>{\r\n        imageResize(imageUrl,photo.type).then(image=>{\r\n          this.props.onSubmitProfile(name,tel,image,photo.type,this.state.isUpdate)\r\n        })\r\n      })\r\n    }\r\n    if(this.state.isUpdate) {\r\n      if(photo){\r\n        readFileAsUrl(photo).then(imageUrl=>{\r\n          imageResize(imageUrl,photo.type).then(image=>{\r\n            this.props.onSubmitProfile(name,tel,image,photo.type,this.state.isUpdate)\r\n          })\r\n        })\r\n      }\r\n      else {\r\n        this.props.submitProfileWithoutPicture(name,tel)\r\n      }\r\n    }\r\n  }\r\n  componentDidUpdate (prevState,nextState) {\r\n  }\r\n  render(){\r\n    const { classes } = this.props\r\n    const { isUpdate,name,tel } = this.state\r\n    let form=(<Fragment>\r\n        <Paper className={classes.paper}>\r\n          <form className={classes.form} noValidate={true} onSubmit={(event)=>this.submitProfileForm(event)}>\r\n            <div className={classes.logoContainer}><div><img src={Logo} alt=\"mob store\"/></div></div>\r\n            <div className={classes.heading}>\r\n              <Typography variant=\"h5\" color=\"secondary\" align=\"center\" gutterBottom>\r\n                {isUpdate?'Update your profile':'Create your profile'}\r\n              </Typography>\r\n            </div>\r\n            <div className={classes.profileDetails}>\r\n              <TextField\r\n                className={classes.textField}\r\n                required\r\n                id='name'\r\n                label=\"Full Name\"\r\n                type=\"text\"\r\n                name=\"name\"\r\n                value={isUpdate && name ?name:' '}\r\n                onChange={(event)=> this.handleInputChange(event, 'name')}\r\n                variant=\"standard\"\r\n                autoComplete=\"name\"\r\n                fullWidth\r\n                margin=\"normal\"\r\n                />\r\n              <TextField\r\n                className={classes.textField}\r\n                required\r\n                id='tel'\r\n                label=\"Telephone Number\"\r\n                type=\"tel\"\r\n                name=\"phone\"\r\n                value={isUpdate && tel?tel:' '}\r\n                onChange={(event)=> this.handleInputChange(event, 'tel')}\r\n                variant=\"standard\"\r\n                autoComplete=\"tel\"\r\n                fullWidth\r\n                margin=\"normal\"\r\n                />\r\n                <TextField\r\n                  className={classes.textField}\r\n                  required={this.state.isUpdate?true:false}\r\n                  id='photo'\r\n                  label=\"Profile Picture\"\r\n                  type=\"file\"\r\n                  name=\"photo\"\r\n                  variant=\"standard\"\r\n                  fullWidth\r\n                  margin=\"normal\"\r\n                  />\r\n              <Button type='submit' color='secondary' className={classes.button} variant=\"contained\" size=\"medium\">{isUpdate?'Update Profile':'Create Profile'}</Button>\r\n            </div>\r\n          </form>\r\n        </Paper>\r\n    </Fragment>\r\n    )\r\n    let profileForm = form\r\n    if (this.props.loading){\r\n      profileForm=<Spinner/>\r\n    }\r\n    if (this.props.uploadingImage) {\r\n      profileForm=(\r\n        <Typography\r\n          variant=\"body1\"\r\n          color=\"secondary\"\r\n          align=\"center\"\r\n          style={{width:'100%'}}\r\n          gutterBottom>\r\n          Uploading Image {this.props.imageUploadProgress} % done\r\n          </Typography>)\r\n    }\r\n    if (this.props.error || this.props.uploadingImageFail) {\r\n      let errorMessage='An Error Ocurred please retry';\r\n      profileForm=(\r\n        <Fragment>\r\n          <Typography\r\n            variant=\"body1\"\r\n            color=\"error\"\r\n            align=\"center\"\r\n            style={{width:'100%'}}\r\n            gutterBottom>{errorMessage}</Typography>\r\n          {form}\r\n        </Fragment>\r\n      )\r\n      }\r\n\r\n      return (\r\n        <React.Fragment>\r\n          {this.props.success?<Redirect to='/' />:null}\r\n        <Grid item\r\n          className={classes.container}\r\n          xs={11}\r\n          sm={8}\r\n          md={6}>\r\n           <div className={classes.profile}>\r\n               {profileForm}\r\n            </div>\r\n        </Grid>\r\n      </React.Fragment>\r\n      )\r\n    }\r\n\r\n  }\r\n  const mapStateToProps= state =>({\r\n    userName:state.auth.userName,\r\n    tel:state.auth.tel,\r\n    loading:state.profile.loading,\r\n    success:state.profile.success,\r\n    error:state.profile.success,\r\n    uploadingImage:state.profile.uploadingImage,\r\n    uploadingImageFail:state.profile.uploadingImageFail,\r\n    uploadingImageSuccess:state.profile.uploadingImageSuccess,\r\n    imageUploadProgress:state.profile.imageUploadProgress\r\n  })\r\n  const mapDispatchToProps = dispatch =>({\r\n    onSubmitProfile: (name,tel,img,type,isUpdate)=>dispatch(actions.uploadProfileInfoAsync(name,tel,img,type,isUpdate)),\r\n    submitProfileWithoutPicture: (name,tel)=>dispatch(actions.uploadProfileWithoutPicture(name,tel))\r\n  })\r\n  export default  connect(mapStateToProps,mapDispatchToProps)(withStyles(styles)(Profile));\r\n"],"sourceRoot":""}
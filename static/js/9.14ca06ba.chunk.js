(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{5991:function(e,t,a){"use strict";a.r(t);var n=a(54),r=a(55),o=a(58),i=a(56),l=a(59),s=a(0),c=a.n(s),u=a(10),p=a(70),d=a(214),m=a.n(d),f=a(152),h=a(57),g=a(3),b=function(e){return{container:{display:"flex"},profile:{width:"100%",display:"flex",flexWrap:"wrap",alignSelf:"center"},profileForm:{width:"100%",display:"flex",flexWrap:"wrap",boxSizing:"border-box",padding:"30px"},paper:{width:"100%",display:"flex",flexWrap:"wrap",padding:"40px",boxSizing:"border-box"},form:{display:"flex",flexWrap:"wrap",width:"100%"},logoContainer:{width:"100%",display:"flex",padding:"5px",boxSizing:"border-box","& div":{width:"30%",margin:"0 auto",transform:"rotate(30deg)","& img":{width:"100%",height:"auto"}}},heading:{width:"100%",padding:"5px",boxSizing:"border-box",display:"flex"},profileDetails:{width:"100%",display:"flex",flexWrap:"wrap",boxSizing:"border-box"},textField:{marginBottom:e.spacing.unit},button:{margin:"".concat(e.spacing.unit,"px auto")}}},y=function(e){return new Promise(function(t){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsDataURL(e)})},v=function(e,t){return new Promise(function(a){var n=document.createElement("canvas"),r=new Image;r.onload=function(e){var o=n.getContext("2d");r.height>100&&(r.width*=100/r.height,r.height=100),o.clearRect(0,0,n.width,n.height),n.height=r.height,n.width=r.width,o.drawImage(r,0,0,r.width,r.height),n.toBlob(function(e){a(e)},t)},r.src=e})},w=a(5980),x=a.n(w),E=a(4);x.a.initializeApp({apiKey:"AIzaSyArs2eYMjFtvxRpRmYqWexaDuQnd0OLX44",authDomain:"electrostore-bb2a3.firebaseapp.com",databaseURL:"https://electrostore-bb2a3.firebaseio.com",projectId:"electrostore-bb2a3",storageBucket:"electrostore-bb2a3.appspot.com",messagingSenderId:"41927039846",appId:"1:41927039846:web:47b1904dc2ed6b7c"});var I=function(e,t){return{type:e,data:t}},P=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,l=new Array(r),s=0;s<r;s++)l[s]=arguments[s];return(a=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(l)))).state={isUpdate:!1,name:null,tel:null},a.handleInputChange=function(e,t){switch(t){case"name":a.setState({name:e.target.value});break;case"tel":a.setState({tel:e.target.value});break;default:return null}},a.submitProfileForm=function(e){e.preventDefault();var t=document.getElementById("name").value,n=document.getElementById("tel").value,r=document.getElementById("photo").files[0];a.state.isUpdate||y(r).then(function(e){v(e,r.type).then(function(e){a.props.onSubmitProfile(t,n,e,r.type,a.state.isUpdate)})}),a.state.isUpdate&&(r?y(r).then(function(e){v(e,r.type).then(function(e){a.props.onSubmitProfile(t,n,e,r.type,a.state.isUpdate)})}):a.props.submitProfileWithoutPicture(t,n))},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.setState({isUpdate:null!==this.props.userName,tel:this.props.tel,name:this.props.userName})}},{key:"componentDidUpdate",value:function(e,t){}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.isUpdate,r=a.name,o=a.tel,i=c.a.createElement(s.Fragment,null,c.a.createElement(g.p,{className:t.paper},c.a.createElement("form",{className:t.form,noValidate:!0,onSubmit:function(t){return e.submitProfileForm(t)}},c.a.createElement("div",{className:t.logoContainer},c.a.createElement("div",null,c.a.createElement("img",{src:m.a,alt:"mob store"}))),c.a.createElement("div",{className:t.heading},c.a.createElement(g.u,{variant:"h5",color:"secondary",align:"center",gutterBottom:!0},n?"Update your profile":"Create your profile")),c.a.createElement("div",{className:t.profileDetails},c.a.createElement(g.r,{className:t.textField,required:!0,id:"name",label:"Full Name",type:"text",name:"name",value:n&&r?r:" ",onChange:function(t){return e.handleInputChange(t,"name")},variant:"standard",autoComplete:"name",fullWidth:!0,margin:"normal"}),c.a.createElement(g.r,{className:t.textField,required:!0,id:"tel",label:"Telephone Number",type:"tel",name:"phone",value:n&&o?o:" ",onChange:function(t){return e.handleInputChange(t,"tel")},variant:"standard",autoComplete:"tel",fullWidth:!0,margin:"normal"}),c.a.createElement(g.r,{className:t.textField,required:!!this.state.isUpdate,id:"photo",label:"Profile Picture",type:"file",name:"photo",variant:"standard",fullWidth:!0,margin:"normal"}),c.a.createElement(g.c,{type:"submit",color:"secondary",className:t.button,variant:"contained",size:"medium"},n?"Update Profile":"Create Profile"))))),l=i;if(this.props.loading&&(l=c.a.createElement(f.a,null)),this.props.uploadingImage&&(l=c.a.createElement(g.u,{variant:"body1",color:"secondary",align:"center",style:{width:"100%"},gutterBottom:!0},"Uploading Image ",this.props.imageUploadProgress," % done")),this.props.error||this.props.uploadingImageFail){l=c.a.createElement(s.Fragment,null,c.a.createElement(g.u,{variant:"body1",color:"error",align:"center",style:{width:"100%"},gutterBottom:!0},"An Error Ocurred please retry"),i)}return c.a.createElement(c.a.Fragment,null,this.props.success?c.a.createElement(p.a,{to:"/"}):null,c.a.createElement(g.k,{item:!0,className:t.container,xs:11,sm:8,md:6},c.a.createElement("div",{className:t.profile},l)))}}]),t}(s.Component);t.default=Object(h.b)(function(e){return{userName:e.auth.userName,tel:e.auth.tel,loading:e.profile.loading,success:e.profile.success,error:e.profile.success,uploadingImage:e.profile.uploadingImage,uploadingImageFail:e.profile.uploadingImageFail,uploadingImageSuccess:e.profile.uploadingImageSuccess,imageUploadProgress:e.profile.imageUploadProgress}},function(e){return{onSubmitProfile:function(t,a,n,r,o){return e(function(e,t,a,n,r){return function(o,i){var l=i().auth.idToken;o(I(E.F,null));var s=a,c=x.a.storage().ref(),u=n.match(/jpe?g|png/g)[0],p={contentType:n},d=c.child("profilePictures/"+e+"."+u).put(s,p);d.on(x.a.storage.TaskEvent.STATE_CHANGED,function(e){var t=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+t+"% done"),o(I(E.M,t))},function(e){o(I(E.E,null))},function(){o(I(E.G,null)),d.snapshot.ref.getDownloadURL().then(function(a){var n=i().auth.localId,s={name:e,userId:n,tel:t,photoUrl:a};if(o(I(E.I,null)),r){var p=i().auth.key;fetch("https://electrostore-bb2a3.firebaseio.com/users/".concat(p,".json?auth=").concat(l),{method:"PATCH",body:JSON.stringify(s)}).then(function(e){return e.json()}).then(function(e){o(I(E.J,null))}).catch(function(t){o(I(E.H,null)),c.child("profilePictures/"+e+"."+u).delete().then(function(){}).catch(function(e){})})}else fetch("https://electrostore-bb2a3.firebaseio.com/users.json?auth=".concat(l),{method:"POST",body:JSON.stringify(s)}).then(function(e){return e.json()}).then(function(e){o(I(E.J,null))}).catch(function(t){o(I(E.H,null)),c.child("profilePictures/"+e+"."+u).delete().then(function(){}).catch(function(e){})})})})}}(t,a,n,r,o))},submitProfileWithoutPicture:function(t,a){return e(function(e,t){return function(a,n){a(I(E.I,null));var r={name:e,tel:t},o=n().auth.key,i=n().auth.idToken;fetch("https://electrostore-bb2a3.firebaseio.com/users/".concat(o,".json?auth=").concat(i),{method:"PATCH",body:JSON.stringify(r)}).then(function(e){return e.json()}).then(function(e){a(I(E.J,null))}).catch(function(e){a(I(E.H,null))})}}(t,a))}}})(Object(u.withStyles)(b)(P))}}]);
//# sourceMappingURL=9.14ca06ba.chunk.js.map